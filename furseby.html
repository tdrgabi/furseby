<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>furseby.lisp</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  
  <div class='section'>
    <div class='docs'><h1>furseby.lisp</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p><strong>Furseby</strong> is an extensible webscrapper + GUI</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre> </pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <h2>Left To do</h2>
<ul>
<li>show some results in gui</li>
<li>research how packages are normally loaded (google.com/codesearch) since quickload takes a while</li>
<li>do something about the paths using official clisp syntax</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre> </pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <h2>Introduction</h2>
<p>Everytime I find a site with free, public domain, books, I bookmark it and never visit it again. I will write a new plugin for each site I find, plugin that knows how to download and present the books I'm searching for. Then, I could simply type a search criteria like "Dante" and the search will be performed on all sites. The goal is to make this async, but for now the searches will be done in serial.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <h2>Get the code</h2>
<p><a href="http://github.com/tdrgabi/furseby">github.com/tdrgabi/furseby</a></p>
<p>The main file, furseby.lisp, contains the gui code. It includes the core.lisp file which has all the functions required to post the query, parse and get results and the only plugin, currently available, the gutenberg plugin. The whole idea is that for a new site we add just the plugin, there is no need to write any other code. The plugin will define some xpath query and return the results in a predefined form. Thus the gui can show the results.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <h3>Packages</h3>
<ul>
<li><a href="furseby.html">furseby</a> gui code</li>
<li><a href="core.html">furseby.core</a> core functions for applying criterias to all sites and collecting results</li>
<li><a href="gutenberg.html">furseby.plugins.gutenberg</a> sample plugin to search project gutenberg</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre> </pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <h2>The code in detail</h2>
<p>This package has the standard structure. Libraries, compile and load own packages, define current package and some gui code
The gui was built with some GUI designer, which outputs .glade files. Then, using cl-gtk2-gtk library, we build the objects from the glade file</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre> </pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <h3>Used libraries</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="p">(</span><span class="nv">ql:quickload</span> <span class="s">&quot;cl-gtk2-gtk&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nv">ql:quickload</span> <span class="s">&quot;drakma&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nv">ql:quickload</span> <span class="s">&quot;cl-libxml2&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nv">ql:quickload</span> <span class="s">&quot;lisp-unit&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nv">ql:quickload</span> <span class="s">&quot;url-rewrite&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <h3>Loading packages</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="p">(</span><span class="nb">load</span> <span class="p">(</span><span class="nb">compile-file</span> <span class="s">&quot;/home/tudor/git/furseby/src/core.lisp&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nb">load</span> <span class="p">(</span><span class="nb">compile-file</span> <span class="s">&quot;/home/tudor/git/furseby/src/plugins/gutenberg.lisp&quot;</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <h3>Package definition</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="p">(</span><span class="nb">defpackage</span> <span class="ss">:fur-seby</span>
  <span class="p">(</span><span class="ss">:use</span> <span class="ss">:cl</span> <span class="ss">:gtk</span> <span class="ss">:gdk</span> <span class="ss">:gobject</span> <span class="ss">:iter</span> <span class="ss">:drakma</span> <span class="ss">:html</span> <span class="ss">:puri</span> <span class="ss">:xpath</span> <span class="ss">:iter</span> <span class="ss">:url-rewrite</span>
        <span class="ss">:furseby.core</span>
        <span class="ss">:furseby.plugins.gutenberg</span><span class="p">))</span>

<span class="p">(</span><span class="nb">in-package</span> <span class="ss">:fur-seby</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <h3>GUI code</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="p">(</span><span class="nb">defun</span> <span class="nv">run</span> <span class="p">()</span>
  <span class="p">(</span><span class="nv">within-main-loop</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">builder</span> <span class="p">(</span><span class="nb">make-instance</span> <span class="ss">&#39;builder</span><span class="p">)))</span>
          <span class="p">(</span><span class="nv">builder-add-from-file</span> <span class="nv">builder</span> <span class="p">(</span><span class="nb">namestring</span> <span class="s">&quot;/home/tudor/furseby.glade&quot;</span><span class="p">))</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">window</span> <span class="p">(</span><span class="nv">builder-get-object</span> <span class="nv">builder</span> <span class="s">&quot;window&quot;</span><span class="p">))</span>
            <span class="p">(</span><span class="nv">search-field</span> <span class="p">(</span><span class="nv">builder-get-object</span> <span class="nv">builder</span> <span class="s">&quot;search-field&quot;</span><span class="p">))</span>
            <span class="p">(</span><span class="nv">result-label</span> <span class="p">(</span><span class="nv">builder-get-object</span> <span class="nv">builder</span> <span class="s">&quot;result-label&quot;</span><span class="p">))</span>
            <span class="p">(</span><span class="nv">result-view</span> <span class="p">(</span><span class="nv">builder-get-object</span> <span class="nv">builder</span> <span class="s">&quot;result-view&quot;</span><span class="p">))</span>
            <span class="p">(</span><span class="nv">prev</span> <span class="p">(</span><span class="nv">builder-get-object</span> <span class="nv">builder</span> <span class="s">&quot;prev&quot;</span><span class="p">))</span>
            <span class="p">(</span><span class="nv">copy</span> <span class="p">(</span><span class="nv">builder-get-object</span> <span class="nv">builder</span> <span class="s">&quot;copy&quot;</span><span class="p">))</span>
            <span class="p">(</span><span class="nv">next</span> <span class="p">(</span><span class="nv">builder-get-object</span> <span class="nv">builder</span> <span class="s">&quot;next&quot;</span><span class="p">)))</span>
           <span class="p">(</span><span class="nv">g-signal-connect</span> <span class="nv">window</span> <span class="s">&quot;destroy&quot;</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">w</span><span class="p">)</span> <span class="p">(</span><span class="k">declare</span> <span class="p">(</span><span class="k">ignore</span> <span class="nv">w</span><span class="p">))</span> <span class="p">(</span><span class="nv">leave-gtk-main</span><span class="p">)))</span>
           <span class="p">(</span><span class="nv">widget-show</span> <span class="nv">window</span><span class="p">)))))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <h3>How to run</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>(load (compile-file "/home/tudor/git/furseby/src/furseby.lisp"))</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>(search-all-sites "Bovary")</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>(run)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
